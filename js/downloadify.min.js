/* Downloadify 0.2 (c) 2009 by Douglas Neiner. Licensed under the MIT license */
/* See http://github.com/dcneiner/Downloadify for license and more info */
(function(){Downloadify=window.Downloadify={queue:{},uid:(new Date).getTime(),getTextForSave:function(e){var t=Downloadify.queue[e];if(t)return t.getData();return""},getFileNameForSave:function(e){var t=Downloadify.queue[e];if(t)return t.getFilename();return""},getDataTypeForSave:function(e){var t=Downloadify.queue[e];if(t)return t.getDataType();return""},getTextForCopy:function(e){var t=Downloadify.queue[e];if(t)return t.getTextCopy();return""},saveComplete:function(e){var t=Downloadify.queue[e];if(t)t.complete();return true},saveCancel:function(e){var t=Downloadify.queue[e];if(t)t.cancel();return true},saveError:function(e){var t=Downloadify.queue[e];if(t)t.error();return true},addToQueue:function(e){Downloadify.queue[e.queue_name]=e},getUID:function(e){if(e.id=="")e.id="downloadify_"+Downloadify.uid++;return e.id}};Downloadify.create=function(e,t){var n=typeof e=="string"?document.getElementById(e):e;return new Downloadify.Container(n,t)};Downloadify.Container=function(e,t){var n=this;n.el=e;n.enabled=true;n.dataCallback=null;n.filenameCallback=null;n.textcopyCallback=null;n.data=null;n.filename=null;var r=function(){n.options=t;if(!n.options.append)n.el.innerHTML="";n.flashContainer=document.createElement("span");n.el.appendChild(n.flashContainer);n.queue_name=Downloadify.getUID(n.flashContainer);if(typeof n.options.filename==="function")n.filenameCallback=n.options.filename;else if(n.options.filename)n.filename=n.options.filename;if(typeof n.options.data==="function")n.dataCallback=n.options.data;else if(n.options.data)n.data=n.options.data;if(typeof n.options.textcopy==="function")n.textcopyCallback=n.options.textcopy;else if(n.options.textcopy)n.textcopy=n.options.textcopy;var e={queue_name:n.queue_name,width:n.options.width,height:n.options.height};var r={allowScriptAccess:"always"};var i={id:n.flashContainer.id,name:n.flashContainer.id};if(n.options.enabled===false)n.enabled=false;if(n.options.transparent===true)r.wmode="transparent";if(n.options.downloadImage)e.downloadImage=n.options.downloadImage;swfobject.embedSWF(n.options.swf,n.flashContainer.id,n.options.width,n.options.height,"10",null,e,r,i);Downloadify.addToQueue(n)};n.enable=function(){var e=document.getElementById(n.flashContainer.id);e.setEnabled(true);n.enabled=true};n.disable=function(){var e=document.getElementById(n.flashContainer.id);e.setEnabled(false);n.enabled=false};n.getData=function(){if(!n.enabled)return"";if(n.dataCallback)return n.dataCallback();else if(n.data)return n.data;else return""};n.getFilename=function(){if(n.filenameCallback)return n.filenameCallback();else if(n.filename)return n.filename;else return""};n.getDataType=function(){if(n.options.dataType)return n.options.dataType;return"string"};n.getTextCopy=function(){if(n.textcopyCallback)return n.textcopyCallback();else if(n.textcopy)return n.textcopy;else return""};n.complete=function(){if(typeof n.options.onComplete==="function")n.options.onComplete()};n.cancel=function(){if(typeof n.options.onCancel==="function")n.options.onCancel()};n.error=function(){if(typeof n.options.onError==="function")n.options.onError()};r()};Downloadify.defaultOptions={swf:"media/downloadify.swf",downloadImage:"images/download.png",width:100,height:30,transparent:true,append:false,dataType:"string"}})();if(typeof jQuery!="undefined"){(function(e){e.fn.downloadify=function(t){return this.each(function(){t=e.extend({},Downloadify.defaultOptions,t);var n=Downloadify.create(this,t);e(this).data("Downloadify",n)})}})(jQuery)}if(typeof MooTools!="undefined"){Element.implement({downloadify:function(e){e=$merge(Downloadify.defaultOptions,e);return this.store("Downloadify",Downloadify.create(this,e))}})}
